!function(a,d){return"function"===typeof require&&typeof exports===typeof module?module.exports=d:a.async=d}(this,function(){var a,d,c;a=function(g){if("undefined"===typeof this.serial){var b=new a,c;for(c in g)b[c](g[c]);return b}this.a=[];this.beginning_result=g;this.processed=this.beginning_length=0;this.q={};this.processing=!1};a.prototype._apply=function(a){if(this.a.length)return(a[0]?this.a.splice(0,this.a.length).shift():this.a[this.a.length-1]).apply({},a)};a.prototype._next=function(a){var b=
this;return function(){b.processed++;if(arguments[0])return b._apply(arguments);b.afterEach_callback.apply(b._next(!b.afterEach_callback.length),arguments);if(!a||b.processed===b.beginning_length)for(;b._apply(arguments)&&a;);}};a.prototype._push=function(a,b){var c,d,e,h,f=this;e=a[0];"[object Function]"===Object.prototype.toString.call(e)&&(c=e=[e]);h=function(b,c){f.beginning_length++;return f.a.push(function(){var d;f.a.pop();f.beforeEach_callback.apply(f._next(!f.beforeEach_callback.length),
arguments);a=Array.prototype.slice.apply(arguments).slice(1);b.apply(d=f._next(c),a.concat(d));return c&&(1===f.a.length||!!f._apply(arguments))})};for(d in e)h(e[d],null===b?!e[d].length:b);return c?this:this.end("function"===typeof a[1]?a[1]:function(){})};a.prototype.end=a.prototype["finally"]=a.prototype.ensure=a.prototype.afterAll=a.prototype.after=a.prototype.complete=a.prototype.done=a.prototype.go=function(a){var b=this;if(this.beginning_length&&!this.processing)return this.processing=!0,
this.a.push(function(){arguments[0]?b.error_callback.apply(b._next(!b.error_callback.length),arguments):b.success_callback.apply(b._next(!b.success_callback.length),arguments);b.processing=!1;if("function"===typeof a)return a.apply(null,arguments)}),this.a.reverse(),(this.begin_callback=this.begin_callback||function(){})&&(this.beforeAll_callback=this.beforeAll_callback||function(){})&&(this.beforeEach_callback=this.beforeEach_callback||function(){})&&(this.afterEach_callback=this.afterEach_callback||
function(){})&&(this.error_callback=this.error_callback||function(){})&&(this.success_callback=this.success_callback||function(){}),this.beforeAll_callback.apply(this._next(!this.beforeAll_callback.length),arguments),this._apply("u"===(typeof this.beginning_result)[0]?[null]:[null,this.beginning_result]),this};a.prototype.serial=a.prototype.series=a.prototype.blocking=a.prototype.waterfall=function(){return this._push(arguments,!1)};a.prototype.parallel=a.prototype.nonblocking=function(){return this._push(arguments,
!0)};a.prototype["do"]=a.prototype.then=a.prototype["try"]=a.prototype.begin=a.prototype.start=a.prototype.auto=function(){return this._push(arguments,null)};a.prototype["new"]=a.prototype.flow=a.prototype["with"]=function(a){this.beginning_result=a;return this};a.prototype.nextTickGroup=a.prototype.push=function(c,b){this.q[c]=this.q[c]||new a;this.q[c].serial(b).go();return this};(d=function(a){return function(b){this[a+"_callback"]=b;return this}})&&(a.prototype.beforeAll=a.prototype.before=d("beforeAll"))&&
(a.prototype.beforeEach=d("beforeEach"))&&(a.prototype.afterEach=a.prototype.between=a.prototype.inbetween=d("afterEach"))&&(a.prototype.error=a.prototype["catch"]=a.prototype.rescue=d("error"))&&(a.prototype.success=a.prototype["else"]=d("success"));(c=function(c){return function(){var b;return(b=new a)[c].apply(b,arguments)}})&&(a.serial=a.series=a.blocking=a.waterfall=c("serial"))&&(a.parallel=a.nonblocking=c("parallel"))&&(a["do"]=a.then=a["try"]=a.begin=a.start=a.auto=c("do"))&&(a.end=a["finally"]=
a.ensure=a.afterAll=a.after=a.complete=a.done=a.go=c("end"))&&(a["new"]=a.flow=a["with"]=c("new"))&&(a.beforeAll=a.before=c("beforeAll"))&&(a.beforeEach=c("beforeEach"))&&(a.afterEach=a.between=a.inbetween=c("afterEach"))&&(a.error=a["catch"]=a.rescue=c("error"))&&(a.success=a["else"]=c("success"))&&(a.nextTickGroup=a.push=c("push"));a.whilst=function(a,b,c){var d=this;a()&&b(function(e){return!!e&&c(e)||d.whilst(a,b,c)})||c()};a.delay=function(a,b){return setTimeout(b,a)};return a}());
